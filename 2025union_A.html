<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2025 çµ±ä¸€Aæ–¹æ¡ˆåŠ é¸é …ç›®è¡¨</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    #selected-items li.font-bold {
      margin-top: 1rem;
      color: #1d4ed8;
      font-weight: 700;
    }

    #package-note span.imaging-label {
      color: #1e40af;
      /* æ·±è— */
      font-weight: bold;
    }

    #package-note span.imaging-content {
      color: #3b82f6;
      /* æ·ºè— */
    }

    #package-note span.tube-label {
      color: #92400e;
      /* æ·±æ©˜ */
      font-weight: bold;
    }

    #package-note span.tube-content {
      color: #f59e0b;
      /* æ·ºæ©˜ */
    }

    #package-note .tube-purple {
      color: #5f19a1;
      /* ç´«è‰² */
    }

    #package-note .tube-purpleyellow {
      color: #d046ef;
      /* ç´«é»ƒè‰² */
    }

    #package-note .tube-lightblue {
      color: #38bdf8;
      /* æ·ºè— */
    }

    #package-note .tube-red {
      color: #ef4444;
      /* ç´…è‰² */
    }

    #package-note .imaging-b2 {
      color: #be185d;
      /* ç²‰ç´… B2 */
    }

    #package-note .imaging-b1 {
      color: steelblue;
      /* steelblue B1 */
    }
  </style>
</head>

<body class="bg-gray-100 text-gray-900">
  <div class="max-w-4xl mx-auto p-6">
    <h1 class="text-3xl font-bold mb-4 text-center">å¥æª¢åŠ é¸é …ç›®æŸ¥è©¢</h1>
    <div class="mb-4">
      <label for="patient-id" class="block mb-1 font-medium">ç—…æ­·è™Ÿï¼š</label>
      <input id="patient-id" type="text" class="w-full p-2 border rounded" placeholder="è«‹è¼¸å…¥ç—…æ­·è™Ÿ" />
    </div>

    <div class="mb-4">
      <label for="gender" class="block mb-1 font-medium">é¸æ“‡æ€§åˆ¥ï¼š</label>
      <select id="gender" class="w-full p-2 border rounded">
        <option value="all">ä¸é™</option>
        <option value="male">ç”·</option>
        <option value="female">å¥³</option>
      </select>
    </div>

    <div class="space-y-4 mb-6">
      <div class="bg-white p-4 rounded shadow">
        <div class="flex justify-between items-center">
          <h2 class="text-lg font-bold text-orange-700">ğŸ“¦ Aå¼ å„å™¨å®˜åŠŸèƒ½æª¢æŸ¥ï¼ˆå°ˆæ¡ˆåƒ¹$3000ï¼‰åŸåƒ¹3100</h2>
          <button onclick="addGroup('A')" class="text-sm bg-orange-600 text-white px-3 py-1 rounded">æ•´çµ„åŠ å…¥</button>
        </div>
        <ul id="groupA-list" class="list-disc pl-6 mt-2">
          <!-- è‚åŠŸèƒ½æª¢æŸ¥ -->
          <li class="flex justify-between items-center gap-2 font-bold text-orange-400 mt-2">è‚åŠŸèƒ½æª¢æŸ¥ ($700)ï¼š
            <button onclick="addItemByName('è‚åŠŸèƒ½æª¢æŸ¥')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2 text-sm">
            ä¸™é…®è½‰æ°¨é…µç´ ï¼ˆSGPTï¼‰ã€è‰é…¸è½‰æ°¨åŸºé…µç´ ï¼ˆSGOTï¼‰ã€ç™½è›‹ç™½/çƒè›‹ç™½ï¼ˆA/Gï¼‰ã€é¹¼æ€§ç£·é…¸é…¶ï¼ˆALK-Pï¼‰ã€ç™½è›‹ç™½ï¼ˆALBï¼‰ã€çƒè›‹ç™½ï¼ˆGLOBï¼‰ã€ç¸½è›‹ç™½ï¼ˆT-Pï¼‰ã€çˆç‘ªéº©æ°¨é…¸é…µç´ ï¼ˆr-GTï¼‰
          </li>
          <!-- è†½åŠŸèƒ½æª¢æŸ¥ -->
          <li class="font-bold text-orange-400 mt-2">è†½åŠŸèƒ½æª¢æŸ¥ ($200)ï¼š</li>
          <li class="flex justify-between items-center gap-2 text-sm">
            ç¸½è†½ç´…ç´ ï¼ˆT-Bilï¼‰ã€ç›´æ¥è†½ç´…ç´ ï¼ˆD-Bilï¼‰
            <button onclick="addItemByName('è†½åŠŸèƒ½æª¢æŸ¥')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <!-- èƒ°è‡ŸåŠŸèƒ½æª¢æŸ¥ -->
          <li class="font-bold text-orange-400 mt-2">èƒ°è‡ŸåŠŸèƒ½æª¢æŸ¥ ($400)ï¼š</li>
          <li class="flex justify-between items-center gap-2 text-sm">
            æ¾±ç²‰é…µç´ ï¼ˆAmylaseï¼‰ã€è§£è„‚é…¶ï¼ˆLipase
            <button onclick="addItemByName('èƒ°è‡ŸåŠŸèƒ½æª¢æŸ¥')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <!-- è…åŠŸèƒ½æª¢æŸ¥ -->
          <li class="font-bold text-orange-400 mt-2">è…åŠŸèƒ½æª¢æŸ¥ ($400)ï¼š</li>
          <li class="flex justify-between items-center gap-2 text-sm">
            è‚Œé…¸é…ï¼ˆCreatinineï¼‰ã€å°¿ç´ é¡ï¼ˆBUNï¼‰ã€è…çµ²çƒéæ¿ƒç‡ï¼ˆeGFRï¼‰ã€å°¿é…¸ï¼ˆUricAcid
            <button onclick="addItemByName('è…åŠŸèƒ½æª¢æŸ¥')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <!-- è¡€ç³–æª¢æŸ¥ -->
          <li class="font-bold text-orange-400 mt-2">è¡€ç³–æª¢æŸ¥ ($300)ï¼š</li>
          <li class="flex justify-between items-center gap-2 text-sm">
            é£¯å‰è¡€ç³–ï¼ˆAC sugar
            <button onclick="addItemByName('è¡€ç³–æª¢æŸ¥')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <!-- è¡€è„‚è‚ªæª¢æŸ¥ -->
          <li class="flex justify-between items-center gap-2 font-bold text-orange-400 mt-2">è¡€è„‚è‚ªæª¢æŸ¥ ($700)ï¼š<button
              onclick="addItemByName('è¡€è„‚è‚ªæª¢æŸ¥')" class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
          <li class="flex justify-between items-centï¼ˆr gap-2 text-sm">
            ç¸½è†½å›ºé†‡ï¼ˆTotal Cholesterolï¼‰ã€ä¸‰é…¸ç”˜æ²¹é…¯ï¼ˆTriglycerideï¼‰ã€é«˜å¯†åº¦è„‚è›‹ç™½ï¼ˆHDL-Cï¼‰ã€ä½å¯†åº¦è„‚è›‹ç™½(LDL-C)ã€ä½å¯†åº¦è„‚è›‹ç™½/é«˜å¯†åº¦è„‚è›‹ç™½
            ï¼ˆLDL/HDLï¼‰ã€ç¸½è†½å›ºé†‡/é«˜å¯†åº¦è„‚è›‹ç™½æ¯”å€¼ï¼ˆTC/HDL
          </li>
          <!-- å¿ƒè‡Ÿæ©Ÿèƒ½æª¢æŸ¥ -->
          <li class="font-bold text-orange-400 mt-2">å¿ƒè‡Ÿæ©Ÿèƒ½æª¢æŸ¥ ($400)ï¼š</li>
          <li class="flex justify-between items-centï¼ˆr gap-2 text-sm">
            ä¹³é…¸è„«æ°«é…µç´ ï¼ˆLDHï¼‰ã€è‚Œé…¸æ¿€é…µç´ (CPK)
            <button onclick="addItemByName('å¿ƒè‡Ÿæ©Ÿèƒ½æª¢æŸ¥')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
        </ul>
      </div>

      <div id="box-b" class="bg-white p-4 rounded shadow">
        <div class="flex justify-between items-center">
          <h2 class="text-lg font-bold text-green-800">ğŸ“¦ Bå¼ ç™Œç—‡ç¯©æª¢ï¼ˆä¾æ€§åˆ¥é¡¯ç¤º B1 æˆ– B2ï¼‰</h2>
        </div>
        <p class="text-sm text-gray-600 mt-2">è«‹é¸æ“‡æ€§åˆ¥ä»¥æŸ¥çœ‹å°æ‡‰çš„ç™Œç—‡ç¯©æª¢å¥—é¤</p>
      </div>
      <div id="box-b1" class="hidden bg-white p-4 rounded shadow">
        <div class="flex justify-between items-center">
          <h2 class="text-lg font-bold text-[steelblue]">ğŸ“¦ B1 ç”·æ€§ç™Œç—‡ç¯©æª¢ï¼ˆ$3000ï¼‰åŸåƒ¹3400</h2>
          <button onclick="addGroup('B1')" class="text-sm bg-[steelblue] text-white px-3 py-1 rounded">æ•´çµ„åŠ å…¥</button>
        </div>
        <ul id="groupB1-list" class="list-disc pl-6 mt-2">
          <li class="flex justify-between items-center gap-2">ç”²å‹èƒå…’è›‹ç™½ AFP $500<button
              onclick="addItemByName('ç”²å‹èƒå…’è›‹ç™½ AFP')" class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
          <li class="flex justify-between items-center gap-2">ç™ŒèƒšèƒæŠ—åŸ CEA $500<button onclick="addItemByName('ç™ŒèƒšèƒæŠ—åŸ CEA')"
              class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
          <li class="flex justify-between items-center gap-2">èƒ°è‡Ÿç™Œ CA-199 $800<button
              onclick="addItemByName('èƒ°è‡Ÿç™Œ CA-199')" class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
          <li class="flex justify-between items-center gap-2">å‰åˆ—è…ºç‰¹å®šæŠ—åŸ Total PSA $600<button
              onclick="addItemByName('å‰åˆ—è…ºç‰¹å®šæŠ—åŸ Total PSA')" class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
          <li class="flex justify-between items-center gap-2">è‚ºè…ºç™Œç¯©æª¢ Cyfra21-1 $1,000<button
              onclick="addItemByName('è‚ºè…ºç™Œç¯©æª¢ Cyfra21-1')" class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
        </ul>
      </div>

      <div id="box-b2" class="hidden bg-white p-4 rounded shadow">
        <div class="flex justify-between items-center">
          <h2 class="text-lg font-bold text-pink-700">ğŸ“¦ B2 å¥³æ€§ç™Œç—‡ç¯©æª¢ï¼ˆ$3000ï¼‰åŸåƒ¹3400</h2>
          <button onclick="addGroup('B2')" class="text-sm bg-pink-600 text-white px-3 py-1 rounded">æ•´çµ„åŠ å…¥</button>
        </div>
        <ul id="groupB2-list" class="list-disc pl-6 mt-2">
          <li class="flex justify-between items-center gap-2">ç”²å‹èƒå…’è›‹ç™½ AFP $500<button
              onclick="addItemByName('ç”²å‹èƒå…’è›‹ç™½ AFP')" class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
          <li class="flex justify-between items-center gap-2">ç™ŒèƒšèƒæŠ—åŸ CEA $500<button onclick="addItemByName('ç™ŒèƒšèƒæŠ—åŸ CEA')"
              class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
          <li class="flex justify-between items-center gap-2">èƒ°è‡Ÿç™Œ CA-199 $800<button
              onclick="addItemByName('èƒ°è‡Ÿç™Œ CA-199')" class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
          <li class="flex justify-between items-center gap-2">ä¹³ç™Œ CA-153 $600<button onclick="addItemByName('ä¹³ç™Œ CA-153')"
              class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
          <li class="flex justify-between items-center gap-2">è‚ºè…ºç™Œç¯©æª¢ Cyfra21-1 $1,000<button
              onclick="addItemByName('è‚ºè…ºç™Œç¯©æª¢ Cyfra21-1')" class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
        </ul>
      </div>

      <div class="bg-white p-4 rounded shadow">
        <div class="flex justify-between items-center">
          <h2 class="text-lg font-bold text-blue-700">ğŸ“¦ Cå¼ é«˜éšå¿ƒè‡Ÿè¡€ç®¡ç¯©æª¢ï¼ˆ$3500ï¼‰åŸåƒ¹3650</h2>
          <button onclick="addGroup('C')" class="text-sm bg-blue-600 text-white px-3 py-1 rounded">æ•´çµ„åŠ å…¥</button>
        </div>
        <ul id="groupC-list" class="list-disc pl-6 mt-2">
          <li class="flex justify-between items-center gap-2">é«˜æ•æ„Ÿåº¦Cåæ‡‰è›‹ç™½ Hs-CRP $350 <button
              onclick="addItemByName('é«˜æ•æ„Ÿåº¦Cåæ‡‰è›‹ç™½ Hs-CRP')" class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
          <li class="flex justify-between items-center gap-2">å¿ƒè‡ŸåŠŸèƒ½æª¢æŸ¥ CK-MB $800<button
              onclick="addItemByName('å¿ƒè‡ŸåŠŸèƒ½æª¢æŸ¥ CK-MB')" class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
          <li class="flex justify-between items-center gap-2">åŒåŠèƒ±èƒºé…¸ Homocysteine $1000<button
              onclick="addItemByName('åŒåŠèƒ±èƒºé…¸ Homocysteine')" class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
          <li class="flex justify-between items-center gap-2">è¡€æ “å› å­ D-Dimer $1500<button
              onclick="addItemByName('è¡€æ “å› å­ D-Dimer')" class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
        </ul>
      </div>

      <div class="bg-white p-4 rounded shadow">
        <div class="flex justify-between items-center">
          <h2 class="text-lg font-bold text-yellow-700">ğŸ“¦ Då¼ æ–°é™³ä»£è¬èˆ‡å…§åˆ†æ³Œç¯©æª¢ï¼ˆ$2000ï¼‰åŸåƒ¹2460</h2>
          <button onclick="addGroup('D')" class="text-sm bg-yellow-600 text-white px-3 py-1 rounded">æ•´çµ„åŠ å…¥</button>
        </div>
        <ul id="groupD-list" class="list-disc pl-6 mt-2">
          <li class="flex justify-between items-center gap-2">ç”²ç‹€è…ºåŠŸèƒ½ T3ã€T4ã€TSH $1000<button
              onclick="addItemByName('ç”²ç‹€è…ºåŠŸèƒ½ T3ã€T4ã€TSH')" class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
          <li class="flex justify-between items-center gap-2">æ¸¸é›¢å››ç¢˜ç”²ç‹€è…ºç´  (Free T4) $260<button
              onclick="addItemByName('æ¸¸é›¢å››ç¢˜ç”²ç‹€è…ºç´  (Free T4)')" class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
          <li class="flex justify-between items-center gap-2">ç”²ç‹€è…ºçƒè›‹ç™½ Thyroglobulin $800<button
              onclick="addItemByName('ç”²ç‹€è…ºçƒè›‹ç™½ Thyroglobulin')" class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
          <li class="flex justify-between items-center gap-2">é¡é¢¨æ¿•å› å­ RA $400<button onclick="addItemByName('é¡é¢¨æ¿•å› å­ RA')"
              class="text-blue-500 text-sm">+ åŠ å…¥</button></li>
        </ul>
      </div>

      <div class="bg-white p-4 rounded shadow">
        <div class="flex justify-between items-center">
          <h2 class="text-lg font-bold text-purple-400">ğŸ“¦ å…¶ä»–é …ç›®</h2>
        </div>
        <ul id="groupOthers-list" class="list-disc pl-6 mt-2">
          <!-- è‚ç‚ç¯©æª¢ -->
          <li class="font-bold text-purple-500 mt-2">è‚ç‚ç¯©æª¢ï¼š</li>
          <li class="flex justify-between items-center gap-2">Aå‹è‚ç‚æŠ—é«”(HAV-IgG) $400
            <button onclick="addItemByName('Aå‹è‚ç‚æŠ—é«”(HAV-IgG)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">Bå‹è‚ç‚è¡¨é¢æŠ—åŸ(HBsAg)ã€Bå‹è‚ç‚è¡¨é¢æŠ—é«” (Anti-HBs) $500
            <button onclick="addItemByName('Bå‹è‚ç‚è¡¨é¢æŠ—åŸ(HBsAg)ã€Bå‹è‚ç‚è¡¨é¢æŠ—é«” (Anti-HBs)')" class="text-blue-500 text-sm">+
              åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">Bå‹è‚ç‚eæŠ—åŸ(HBeAg) $500
            <button onclick="addItemByName('Bå‹è‚ç‚eæŠ—åŸ(HBeAg)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">Cå‹è‚ç‚æŠ—é«”(Anti-HCV) $500
            <button onclick="addItemByName('Cå‹è‚ç‚æŠ—é«”(Anti-HCV)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>

          <!-- ç™Œç—‡æŒ‡æ¨™ -->
          <li class="font-bold text-purple-500 mt-2">ç™Œç—‡æŒ‡æ¨™ï¼š</li>
          <li class="flex justify-between items-center gap-2">è‚ºç™Œ(NSE) $800
            <button onclick="addItemByName('è‚ºç™Œ(NSE)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">é¼»å’½ç™Œ(EBV-IgA) $800
            <button onclick="addItemByName('é¼»å’½ç™Œ(EBV-IgA)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">é±—ç‹€ä¸Šçš®ç´°èƒç™Œ(SCC) $1,000
            <button onclick="addItemByName('é±—ç‹€ä¸Šçš®ç´°èƒç™Œ(SCC)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">åµå·¢ç™Œ(CA-125) $520
            <button onclick="addItemByName('åµå·¢ç™Œ(CA-125)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">èƒƒç™Œ(CA72-4) $800
            <button onclick="addItemByName('èƒƒç™Œ(CA72-4)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">çªä¸¸ç™Œ/çµ¨æ¯›å…§è†œç™Œ(Î²-HCG) $600
            <button onclick="addItemByName('çªä¸¸ç™Œ/çµ¨æ¯›è†œç™Œ Î²-HCG')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>

          <!-- éæ•èˆ‡å…ç–« -->
          <li class="font-bold text-purple-500 mt-2">éæ•èˆ‡å…ç–«ï¼š</li>
          <li class="flex justify-between items-center gap-2">Anti-ENAæŠ—é«”(CTD screen) $350
            <button onclick="addItemByName('Anti-ENAæŠ—é«”(CTD screen)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">éæ•åŸæª¢æ¸¬-50é … $5,000
            <button onclick="addItemByName('éæ•åŸæª¢æ¸¬-50é …')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">éæ•åŸæª¢æ¸¬-100é … $10,000
            <button onclick="addItemByName('éæ•åŸæª¢æ¸¬-100é …')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>

          <!-- å…§åˆ†æ³Œèˆ‡è·çˆ¾è’™ -->
          <li class="font-bold text-purple-500 mt-2">å…§åˆ†æ³Œèˆ‡è·çˆ¾è’™ï¼š</li>
          <li class="flex justify-between items-center gap-2">ç¶­ç”Ÿç´ D3/25 OH Vitamin D3 $1,000
            <button onclick="addItemByName('ç¶­ç”Ÿç´ D3/25 OH Vitamin D3')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">ç¶­ç”Ÿç´ B12 (Vitamin B12) $500
            <button onclick="addItemByName('ç¶­ç”Ÿç´ B12 (Vitamin B12)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">è‘‰é…¸ (Folic acid) $400
            <button onclick="addItemByName('è‘‰é…¸ (Folic acid)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">æ³Œä¹³æ¿€ç´ (Prolactin) $400
            <button onclick="addItemByName('æ³Œä¹³æ¿€ç´ (Prolactin)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">é»ƒé«”ç´ (Progesterone)(å¥³æ€§) $400
            <button onclick="addItemByName('é»ƒé«”ç´ (Progesterone)(å¥³æ€§)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">å¥³æ€§è·çˆ¾è’™ (E2.LH.FSH) $1,200
            <button onclick="addItemByName('å¥³æ€§è·çˆ¾è’™ (E2.LH.FSH)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">æŠ—ç©†å‹’æ°è³€çˆ¾è’™ $800
            <button onclick="addItemByName('æŠ—ç©†å‹’æ°è³€çˆ¾è’™')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>

          <!-- ç³–å°¿ç—…ç›¸é—œè©¦é©— -->
          <li class="font-bold text-purple-500 mt-2">ç³–å°¿ç—…æª¢æŸ¥ï¼š</li>
          <li class="flex justify-between items-center gap-2">é†£åŒ–è¡€è‰²ç´  (HbA1C) $400
            <button onclick="addItemByName('é†£åŒ–è¡€è‰²ç´  (HbA1C)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">èƒ°å³¶ç´ (Insulin)ã€èƒ°å³¶ç´ é˜»æŠ— $600
            <button onclick="addItemByName('èƒ°å³¶ç´ (Insulin)ã€èƒ°å³¶ç´ é˜»æŠ—')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>

          <!-- å…¶ä»–è¡€æ¶²æª¢æŸ¥ -->
          <li class="font-bold text-purple-500 mt-2">å…¶ä»–è¡€æ¶²æª¢æŸ¥ï¼š</li>
          <li class="flex justify-between items-center gap-2">ABOè¡€å‹ $400
            <button onclick="addItemByName('ABOè¡€å‹')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">ç¼ºéµæ€§è²§è¡€(TIBC.Iron.Ferritin) $1,200
            <button onclick="addItemByName('ç¼ºéµæ€§è²§è¡€(TIBC.Iron.Ferritin)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">å¾Œå¤©å…ç–«ç¼ºä¹ç—‡å€™ç¾¤(HIV) $600
            <button onclick="addItemByName('å¾Œå¤©å…ç–«ç¼ºä¹ç—‡å€™ç¾¤(HIV)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li class="flex justify-between items-center gap-2">æ¢…æ¯’åæ‡‰(VDRL) $300
            <button onclick="addItemByName('æ¢…æ¯’åæ‡‰(VDRL)')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>

          <!-- å‘¼æ°£æª¢æŸ¥ -->
          <li class="font-bold text-purple-500 mt-2">å‘¼æ°£æª¢æŸ¥ï¼š</li>
          <li class="flex justify-between items-center gap-2">C13å°¿ç´ å‘¼æ°£æª¢æŸ¥å¹½é–€æ¡¿èŒ $1,500
            <button onclick="addItemByName('C13å°¿ç´ å‘¼æ°£æª¢æŸ¥å¹½é–€æ¡¿èŒ')" class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
        </ul>
      </div>

      <div class="bg-white p-4 rounded shadow">
        <div class="flex justify-between items-center">
          <h2 class="text-lg font-bold text-rose-700">ğŸ“¦ å©šå‰å¥æª¢å¥—é¤</h2>
        </div>
        <p id="marriage-tip" class="text-sm text-gray-600 mt-2">è«‹é¸æ“‡æ€§åˆ¥ä»¥æŸ¥çœ‹å°æ‡‰çš„å©šå‰å¥æª¢å¥—é¤</p>
        <ul class="list-disc pl-6 mt-2">
          <li id="marriage-male" class="flex justify-between items-center gap-2">
            å©šå‰å¥æª¢é …ç›®(ç”·æ€§)-åœ°ä¸­æµ·å‹è²§è¡€(é›»æ³³)ã€è ¶è±†ç—‡G6PDã€ç”·æ€§è·çˆ¾è’™Testosterone $1,600
            <button onclick="addItemByName('å©šå‰å¥æª¢é …ç›®(ç”·æ€§)-åœ°ä¸­æµ·å‹è²§è¡€(é›»æ³³)ã€è ¶è±†ç—‡G6PDã€ç”·æ€§è·çˆ¾è’™Testosterone')"
              class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
          <li id="marriage-female" class="flex justify-between items-center gap-2">
            å©šå‰å¥æª¢é …ç›®(å¥³æ€§)-åœ°ä¸­æµ·å‹è²§è¡€(é›»æ³³)ã€è ¶è±†ç—‡G6PDã€å¾·åœ‹éº»ç–¹Rubella IgGã€æ°´ç—˜æŠ—é«” $2000
            <button onclick="addItemByName('å©šå‰å¥æª¢é …ç›®(å¥³æ€§)-åœ°ä¸­æµ·å‹è²§è¡€(é›»æ³³)ã€è ¶è±†ç—‡G6PDã€å¾·åœ‹éº»ç–¹Rubella IgGã€æ°´ç—˜æŠ—é«”')"
              class="text-blue-500 text-sm">+ åŠ å…¥</button>
          </li>
        </ul>
      </div>

    </div>

    <div class="mt-6 p-4 bg-white shadow rounded">
      <h2 class="text-xl font-semibold mb-2">å·²é¸é …ç›®</h2>
      <ul id="selected-items" class="list-disc pl-6"></ul>
      <p class="mt-2 font-bold">ç¸½é‡‘é¡ï¼š<span id="total-price" class="text-2xl font-bold text-red-600">0</span> å…ƒ</p>
      <p id="package-note" class="text-green-600 font-semibold"></p>
      <div id="specimen-summary" class="mt-2 text-sm text-gray-700"></div>
    </div>

  </div>

  <script>
    const data = [
      { name: "è§£è„‚é…¶(Lipase)", price: 400, specimen: "è¡€æ¶²" },
      { name: "éµè›‹ç™½(Ferritin)", price: 400, specimen: "è¡€æ¶²" },
      { name: "è†½ç´ è„‚é…¶(Cholinesterase)", price: 400, specimen: "è¡€æ¶²" },
      { name: "Bå‹è‚ç‚è¡¨é¢æŠ—åŸ(HBsAg)ã€Bå‹è‚ç‚è¡¨é¢æŠ—é«” (Anti-HBs)", price: 500, specimen: "è¡€æ¶²" },
      { name: "ç™ŒèƒšèƒæŠ—åŸ CEA", price: 500, specimen: "è¡€æ¶²" },
      { name: "èƒ°è‡Ÿç™Œ CA-199", price: 800, specimen: "è¡€æ¶²" },
      { name: "çªä¸¸ç™Œ Î²-HCG", price: 600, specimen: "è¡€æ¶²" },
      { name: "çªä¸¸ç™Œ/çµ¨æ¯›è†œç™Œ Î²-HCG", price: 600, specimen: "è¡€æ¶²" },
      { name: "çµ¨æ¯›è†œç™Œ Î²-HCG", price: 600, specimen: "è¡€æ¶²" },
      { name: "ä¹³ç™Œ CA-153", price: 600, specimen: "è¡€æ¶²" },
      { name: "è‚ºè…ºç™Œç¯©æª¢ Cyfra21-1", price: 1000, specimen: "è¡€æ¶²" },
      { name: "ç”²å‹èƒå…’è›‹ç™½ AFP", price: 500, specimen: "è¡€æ¶²" },
      { name: "å‰åˆ—è…ºç‰¹å®šæŠ—åŸ Total PSA", price: 600, specimen: "è¡€æ¶²" },
      { name: "ç”·æ€§è·çˆ¾è’™æª¢æ¸¬", price: 1000, specimen: "è¡€æ¶²" },
      { name: "é«˜æ•æ„Ÿåº¦Cåæ‡‰è›‹ç™½ Hs-CRP", price: 350, specimen: "è¡€æ¶²" },
      { name: "å¿ƒè‡ŸåŠŸèƒ½æª¢æŸ¥ CK-MB", price: 800, specimen: "è¡€æ¶²" },
      { name: "åŒåŠèƒ±èƒºé…¸ Homocysteine", price: 1000, specimen: "è¡€æ¶²" },
      { name: "è¡€æ “å› å­ D-Dimer", price: 1500, specimen: "è¡€æ¶²" },
      { name: "è¶…å£è†½å›ºé†‡ small-dense LDL", price: 1000, specimen: "è¡€æ¶²" },
      { name: "ç”²ç‹€è…ºåŠŸèƒ½ T3ã€T4ã€TSH", price: 1000, specimen: "è¡€æ¶²" },
      { name: "æ¸¸é›¢å››ç¢˜ç”²ç‹€è…ºç´  (Free T4)", price: 260, specimen: "è¡€æ¶²" },
      { name: "ç”²ç‹€è…ºçƒè›‹ç™½ Thyroglobulin", price: 800, specimen: "è¡€æ¶²" },
      { name: "é¡é¢¨æ¿•å› å­ RA", price: 400, specimen: "è¡€æ¶²" },
      { name: "é›»è§£è³ª Naã€Kã€Clã€Caã€P", price: 300, specimen: "è¡€æ¶²" },
      { name: "éæ•é«”è³ªæª¢æŸ¥ (IgE)", price: 0, specimen: "è¡€æ¶²" },
      { name: "é…’ç²¾ä»£è¬åŸºå› æª¢æ¸¬", price: 2500, specimen: "è¡€æ¶²" },
      { name: "éºå‚³æ€§è½æåŸºå› æª¢æ¸¬", price: 4500, specimen: "è¡€æ¶²" },
      { name: "ApoEé˜¿èŒ²æµ·é»˜ç—‡é¢¨éšªåŸºå› æª¢æ¸¬", price: 3000, specimen: "è¡€æ¶²" },
      { name: "è—¥å®³åŸºå› æª¢æ¸¬ (HLA-B1502)", price: 3500, specimen: "è¡€æ¶²" },
      { name: "å©šå‰å¥æª¢é …ç›®(ç”·æ€§)-åœ°ä¸­æµ·å‹è²§è¡€(é›»æ³³)ã€è ¶è±†ç—‡G6PDã€ç”·æ€§è·çˆ¾è’™Testosterone", price: 1600, specimen: "è¡€æ¶²" },
      { name: "å©šå‰å¥æª¢é …ç›®(å¥³æ€§)-åœ°ä¸­æµ·å‹è²§è¡€(é›»æ³³)ã€è ¶è±†ç—‡G6PDã€å¾·åœ‹éº»ç–¹Rubella IgGã€æ°´ç—˜æŠ—é«”", price: 2000, specimen: "è¡€æ¶²" },
      { name: "æ”è­·è…ºè¶…éŸ³æ³¢", price: 900, specimen: "å½±åƒ" },
      { name: "éª¨ç›†è…”è¶…éŸ³æ³¢", price: 900, specimen: "å½±åƒ" },
      { name: "ç”²ç‹€è…ºè¶…éŸ³æ³¢", price: 900, specimen: "å½±åƒ" },
      { name: "ä¹³æˆ¿è¶…éŸ³æ³¢", price: 900, specimen: "å½±åƒ" },
      { name: "é ¸å‹•è„ˆè¶…éŸ³æ³¢", price: 900, specimen: "å½±åƒ" },
      { name: "Anti-ENAæŠ—é«”(CTD screen)", price: 350, specimen: "è¡€æ¶²" },
      { name: "Aå‹è‚ç‚æŠ—é«”(HAV-IgG)", price: 400, specimen: "è¡€æ¶²" },
      { name: "Bå‹è‚ç‚eæŠ—åŸ(HBeAg)", price: 500, specimen: "è¡€æ¶²" },
      { name: "Cå‹è‚ç‚æŠ—é«”(Anti-HCV)", price: 500, specimen: "è¡€æ¶²" },
      { name: "è‚ºç™Œ(NSE)", price: 800, specimen: "è¡€æ¶²" },
      { name: "é±—ç‹€ä¸Šçš®ç´°èƒç™Œ(SCC)", price: 1000, specimen: "è¡€æ¶²" },
      { name: "é¼»å’½ç™Œ(EBV-IgA)", price: 800, specimen: "è¡€æ¶²" },
      { name: "åµå·¢ç™Œ(CA-125)", price: 520, specimen: "è¡€æ¶²" },
      { name: "èƒƒç™Œ(CA72-4)", price: 800, specimen: "è¡€æ¶²" },
      { name: "éæ•é«”è³ªæª¢æŸ¥ (IgE)", price: 700, specimen: "è¡€æ¶²" },
      { name: "éæ•åŸæª¢æ¸¬-36é …", price: 3000, specimen: "è¡€æ¶²" },
      { name: "éæ•åŸæª¢æ¸¬-50é …", price: 5500, specimen: "è¡€æ¶²" },
      { name: "éæ•åŸæª¢æ¸¬-100é …", price: 10000, specimen: "è¡€æ¶²" },
      { name: "ç¶­ç”Ÿç´ D3/25 OH Vitamin D3", price: 1500, specimen: "è¡€æ¶²" },
      { name: "ç¶­ç”Ÿç´ B12 (Vitamin B12)", price: 500, specimen: "è¡€æ¶²" },
      { name: "è‘‰é…¸ (Folic acid)", price: 400, specimen: "è¡€æ¶²" },
      { name: "æ³Œä¹³æ¿€ç´ (Prolactin)", price: 400, specimen: "è¡€æ¶²" },
      { name: "é»ƒé«”ç´ (Progesterone)(å¥³æ€§)", price: 400, specimen: "è¡€æ¶²" },
      { name: "å¥³æ€§è·çˆ¾è’™ (E2.LH.FSH)", price: 1200, specimen: "è¡€æ¶²" },
      { name: "ç¼ºéµæ€§è²§è¡€(TIBC.Iron.Ferritin)", price: 1200, specimen: "è¡€æ¶²" },
      { name: "æŠ—ç©†å‹’æ°è³€çˆ¾è’™", price: 800, specimen: "è¡€æ¶²" },
      { name: "ABOè¡€å‹", price: 400, specimen: "è¡€æ¶²" },
      { name: "å¾Œå¤©å…ç–«ç¼ºä¹ç—‡å€™ç¾¤(HIV)", price: 600, specimen: "è¡€æ¶²" },
      { name: "æ¢…æ¯’åæ‡‰(VDRL)", price: 300, specimen: "è¡€æ¶²" },
      { name: "C13å°¿ç´ å‘¼æ°£æª¢æŸ¥å¹½é–€æ¡¿èŒ", price: 1500, specimen: "æ°£é«”" },
      { name: "é†£åŒ–è¡€è‰²ç´  (HbA1C)", price: 400, specimen: "è¡€æ¶²" },
      { name: "èƒ°å³¶ç´ (Insulin)ã€èƒ°å³¶ç´ é˜»æŠ—", price: 600, specimen: "è¡€æ¶²" },
      { name: "è‚åŠŸèƒ½æª¢æŸ¥", price: 700, specimen: "è¡€æ¶²" },
      { name: "è†½åŠŸèƒ½æª¢æŸ¥", price: 200, specimen: "è¡€æ¶²" },
      { name: "èƒ°è‡ŸåŠŸèƒ½æª¢æŸ¥", price: 400, specimen: "è¡€æ¶²" },
      { name: "è…åŠŸèƒ½æª¢æŸ¥", price: 400, specimen: "è¡€æ¶²" },
      { name: "è¡€ç³–æª¢æŸ¥", price: 300, specimen: "è¡€æ¶²" },
      { name: "è¡€è„‚è‚ªæª¢æŸ¥", price: 700, specimen: "è¡€æ¶²" },
      { name: "å¿ƒè‡Ÿæ©Ÿèƒ½æª¢æŸ¥", price: 400, specimen: "è¡€æ¶²" },
    ];

    const groupData = {
      A: {
        items: ["è‚åŠŸèƒ½æª¢æŸ¥", "è†½åŠŸèƒ½æª¢æŸ¥", "èƒ°è‡ŸåŠŸèƒ½æª¢æŸ¥", "è…åŠŸèƒ½æª¢æŸ¥", "è¡€ç³–æª¢æŸ¥", "è¡€è„‚è‚ªæª¢æŸ¥", "å¿ƒè‡Ÿæ©Ÿèƒ½æª¢æŸ¥"],
        price: 3000
      },
      B1: {
        items: ["ç”²å‹èƒå…’è›‹ç™½ AFP", "ç™ŒèƒšèƒæŠ—åŸ CEA", "èƒ°è‡Ÿç™Œ CA-199", "å‰åˆ—è…ºç‰¹å®šæŠ—åŸ Total PSA", "è‚ºè…ºç™Œç¯©æª¢ Cyfra21-1"],
        price: 3000
      },
      B2: {
        items: ["ç”²å‹èƒå…’è›‹ç™½ AFP", "ç™ŒèƒšèƒæŠ—åŸ CEA", "èƒ°è‡Ÿç™Œ CA-199", "ä¹³ç™Œ CA-153", "è‚ºè…ºç™Œç¯©æª¢ Cyfra21-1"],
        price: 3000
      },
      C: {
        items: ["é«˜æ•æ„Ÿåº¦Cåæ‡‰è›‹ç™½ Hs-CRP", "å¿ƒè‡ŸåŠŸèƒ½æª¢æŸ¥ CK-MB", "åŒåŠèƒ±èƒºé…¸ Homocysteine", "è¡€æ “å› å­ D-Dimer"],
        price: 3500
      },
      D: {
        items: [
          "ç”²ç‹€è…ºåŠŸèƒ½ T3ã€T4ã€TSH",
          "æ¸¸é›¢å››ç¢˜ç”²ç‹€è…ºç´  (Free T4)",
          "ç”²ç‹€è…ºçƒè›‹ç™½ Thyroglobulin",
          "é¡é¢¨æ¿•å› å­ RA",
        ],
        price: 2000
      }
    };

    const genderSelect = document.getElementById('gender');
    const boxB1 = document.getElementById('box-b1');
    const boxB2 = document.getElementById('box-b2');
    const selectedItems = document.getElementById('selected-items');
    const totalPrice = document.getElementById('total-price');
    const specimenSummary = document.getElementById('specimen-summary');

    let selected = [];
    let previousGender = 'all';

    function removeGroupItems(group) {
      let names = [];
      const hasB1 = groupData.B1.items.every(name => selected.find(item => item.name === name));
      if (group === 'A+B2+C') {
        names = groupData.A.items.concat(groupData.B2.items, groupData.C.items);
      } else if (group === 'A+B2') {
        names = groupData.A.items.concat(groupData.B2.items);
      } else if (group === 'A+B1') {
        names = groupData.A.items.concat(groupData.B1.items);
      } else if (group === 'A+B1+C') {
        names = groupData.A.items.concat(groupData.B1.items, groupData.C.items);
      } else if (group === 'A+Bx+C') {
        names = groupData.A.items.concat(
          hasB1 ? groupData.B1.items : groupData.B2.items,
          groupData.C.items
        );
      } else if (group === 'A+B1+C+D') {
        names = groupData.A.items.concat(
          groupData.B1.items,
          groupData.C.items,
          groupData.D.items,
          ["éæ•é«”è³ªæª¢æŸ¥ (IgE)"]
        );
      } else if (group === 'A+B2+C+D') {
        names = groupData.A.items.concat(
          groupData.B2.items,
          groupData.C.items,
          groupData.D.items,
          ["éæ•é«”è³ªæª¢æŸ¥ (IgE)"]
        );
      } else if (group === 'A+Bx+C+D') {
        names = groupData.A.items.concat(
          hasB1 ? groupData.B1.items : groupData.B2.items,
          groupData.C.items,
          groupData.D.items,
          ["éæ•é«”è³ªæª¢æŸ¥ (IgE)"]
        );
      } else if (group === 'D') {
        names = groupData.D.items;
      } else {
        names = groupData[group].items;
      }
      selected = selected.filter(item => !names.includes(item.name));
      updateSelected();
    }

    genderSelect.addEventListener('change', () => {
      const gender = genderSelect.value;

      if (previousGender === 'male' && gender !== 'male') {
        removeGroupItems('B1');
      } else if (previousGender === 'female' && gender !== 'female') {
        removeGroupItems('B2');
      }
      previousGender = gender;

      boxB1.classList.add('hidden');
      boxB2.classList.add('hidden');
      if (gender === 'male') boxB1.classList.remove('hidden');
      else if (gender === 'female') boxB2.classList.remove('hidden');

      document.getElementById('marriage-male').classList.add('hidden');
      document.getElementById('marriage-female').classList.add('hidden');
      if (gender === 'male') document.getElementById('marriage-male').classList.remove('hidden');
      if (gender === 'female') document.getElementById('marriage-female').classList.remove('hidden');

      const marriageTip = document.getElementById('marriage-tip');
      if (gender === 'all') {
        marriageTip.classList.remove('hidden');
      } else {
        marriageTip.classList.add('hidden');
      }

      // Ensure box-b remains hidden
      document.getElementById('box-b').classList.add('hidden');

      // æ§åˆ¶è¶…éŸ³æ³¢é …ç›®é¡¯ç¤º
      document.querySelector("li:has(button[onclick*=æ”è­·è…ºè¶…éŸ³æ³¢])").classList.add('hidden');
      document.querySelector("li:has(button[onclick*=éª¨ç›†è…”è¶…éŸ³æ³¢])").classList.add('hidden');
      document.querySelector("li:has(button[onclick*=ä¹³æˆ¿è¶…éŸ³æ³¢])").classList.add('hidden');
      if (gender === 'male') {
        document.querySelector("li:has(button[onclick*=æ”è­·è…ºè¶…éŸ³æ³¢])").classList.remove('hidden');
      } else if (gender === 'female') {
        document.querySelector("li:has(button[onclick*=éª¨ç›†è…”è¶…éŸ³æ³¢])").classList.remove('hidden');
        document.querySelector("li:has(button[onclick*=ä¹³æˆ¿è¶…éŸ³æ³¢])").classList.remove('hidden');
      }

      // ç§»é™¤æ€§åˆ¥ç‰¹æœ‰çš„è¶…éŸ³æ³¢èˆ‡å©šå‰å¥æª¢é …ç›®
      const genderSpecificItems = {
        male: [
          "æ”è­·è…ºè¶…éŸ³æ³¢",
          "å©šå‰å¥æª¢é …ç›®(ç”·æ€§)-åœ°ä¸­æµ·å‹è²§è¡€(é›»æ³³)ã€è ¶è±†ç—‡G6PDã€ç”·æ€§è·çˆ¾è’™Testosterone"
        ],
        female: [
          "éª¨ç›†è…”è¶…éŸ³æ³¢",
          "ä¹³æˆ¿è¶…éŸ³æ³¢",
          "å©šå‰å¥æª¢é …ç›®(å¥³æ€§)-åœ°ä¸­æµ·å‹è²§è¡€(é›»æ³³)ã€è ¶è±†ç—‡G6PDã€å¾·åœ‹éº»ç–¹Rubella IgGã€æ°´ç—˜æŠ—é«”"
        ]
      };

      const itemsToRemove = gender === 'male' ? genderSpecificItems.female : gender === 'female' ? genderSpecificItems.male : [...genderSpecificItems.male, ...genderSpecificItems.female];
      selected = selected.filter(item => !itemsToRemove.includes(item.name));

      updateSelected();
    });

    function addGroup(group) {
      const names = groupData[group].items;
      names.forEach(name => {
        if (!selected.find(item => item.name === name)) {
          const itemData = data.find(d => d.name === name);
          if (itemData) selected.push(itemData);
        }
      });
      updateSelected();
    }

    function addItemByName(name) {
      if (!selected.find(i => i.name === name)) {
        const item = data.find(d => d.name === name);
        if (item) {
          selected.push(item);
          updateSelected();
        }
      }
    }

    function removeItemByName(name) {
      const item = data.find(d => d.name === name);
      if (item && item.locked) return; // é–å®šé …ç›®ç„¡æ³•ç§»é™¤
      selected = selected.filter(item => item.name !== name);
      updateSelected();
    }

    function updateSelected() {
      selectedItems.innerHTML = '';
      let total = 0;
      const specimenMap = {};
      let usedGroups = [];

      const hasA = groupData.A.items.every(name => selected.find(item => item.name === name));
      const hasB1 = groupData.B1.items.every(name => selected.find(item => item.name === name));
      const hasB2 = groupData.B2.items.every(name => selected.find(item => item.name === name));
      const hasC = groupData.C.items.every(name => selected.find(item => item.name === name));
      const hasD = groupData.D.items.every(name => selected.find(item => item.name === name));

      if (hasA && (hasB1 || hasB2) && hasC && hasD) {
        usedGroups.push('A+Bx+C+D');
      } else if (hasA && hasC && (hasB1 || hasB2)) {
        usedGroups.push('A+Bx+C');
      } else if (hasA && hasB2 && hasC) {
        usedGroups.push('A+B2+C');
      } else if (hasA && hasB2) {
        usedGroups.push('A+B2');
      } else if (hasA && hasB1 && hasC) {
        usedGroups.push('A+B1+C');
      } else if (hasA && hasB1) {
        usedGroups.push('A+B1');
      } else {
        for (const key in groupData) {
          const group = groupData[key];
          const complete = group.items.every(name => selected.find(item => item.name === name));
          if (complete) usedGroups.push(key);
        }
      }

      let usedNames = new Set();
      usedGroups.forEach(g => {
        if (g === 'A+B2') {
          groupData.A.items.concat(groupData.B2.items).forEach(name => usedNames.add(name));
        } else if (g === 'A+B1') {
          groupData.A.items.concat(groupData.B1.items).forEach(name => usedNames.add(name));
        } else if (g === 'A+B1+C') {
          groupData.A.items.concat(groupData.B1.items, groupData.C.items).forEach(name => usedNames.add(name));
        } else if (g === 'A+Bx+C') {
          groupData.A.items.concat(
            hasB1 ? groupData.B1.items : groupData.B2.items,
            groupData.C.items
          ).forEach(name => usedNames.add(name));
        } else if (g === 'A+Bx+C+D') {
          groupData.A.items.concat(
            hasB1 ? groupData.B1.items : groupData.B2.items,
            groupData.C.items,
            groupData.D.items,
            ["éæ•é«”è³ªæª¢æŸ¥ (IgE)"]
          ).forEach(name => usedNames.add(name));
        } else {
          groupData[g].items.forEach(name => usedNames.add(name));
        }
      });

      const remaining = selected.filter(item => !usedNames.has(item.name));

      const groupTitleMap = {
        A: 'A å¼',
        B1: 'B1 å¼',
        B2: 'B2 å¼',
        C: 'C å¼',
        D: 'D å¼',
        'others': 'å…¶ä»–é …ç›®'
      };
      const groupedItems = { A: [], B1: [], B2: [], C: [], D: [], others: [] };

      remaining.forEach(item => {
        let inGroup = false;
        for (const key in groupData) {
          if (groupData[key].items.includes(item.name)) {
            // Assign to the group with the most matching items in `selected`
            const groupMatchCounts = Object.entries(groupData).map(([g, group]) => {
              const count = group.items.filter(n => selected.some(s => s.name === n)).length;
              return { group: g, count };
            });
            groupMatchCounts.sort((a, b) => b.count - a.count);
            const mostLikelyGroup = groupMatchCounts.find(g => groupData[g.group].items.includes(item.name));
            if (mostLikelyGroup) {
              groupedItems[mostLikelyGroup.group].push(item);
            }
            inGroup = true;
            break;
          }
        }
        if (!inGroup) {
          groupedItems.others.push(item);
        }
      });

      for (const key of ['A', 'B1', 'B2', 'C', 'D', 'others']) {
        if (groupedItems[key].length > 0) {
          const titleLi = document.createElement('li');
          titleLi.className = 'font-bold text-blue-700 mt-2';
          titleLi.textContent = groupTitleMap[key] + 'ï¼š';
          selectedItems.appendChild(titleLi);

          groupedItems[key].forEach(item => {
            const li = document.createElement('li');
            li.className = 'flex justify-between items-center gap-2 ml-4';
            li.innerHTML = `${item.name}ï¼ˆ${item.price} å…ƒï¼‰` +
              (item.locked ? '' : ` <button onclick="removeItemByName('${item.name}')" class="text-red-500 text-sm">âŒ</button>`);
            selectedItems.appendChild(li);
            total += item.price;
            specimenMap[item.specimen] = (specimenMap[item.specimen] || 0) + 1;
          });
        }
      }

      usedGroups.forEach(key => {
        let price = 0;
        let label = '';
        let items = [];

        if (key === 'A+Bx+C+D') {
          price = 7500;
          label = 'A å¼ + B1/B2 å¼ + C å¼ + D å¼ å°ˆæ¡ˆåƒ¹ï¼ˆåŠ è´ˆ IgEï¼‰';
          items = groupData.A.items.concat(
            hasB1 ? groupData.B1.items : groupData.B2.items,
            groupData.C.items,
            groupData.D.items,
            ["éæ•é«”è³ªæª¢æŸ¥ (IgE)"]
          );
        } else if (key === 'A+Bx+C') {
          price = 6000;
          label = 'A å¼ + B1/B2 å¼ + C å¼ å°ˆæ¡ˆåƒ¹';
          items = groupData.A.items.concat(
            hasB1 ? groupData.B1.items : groupData.B2.items,
            groupData.C.items
          );
        } else if (key === 'A+B2+C') {
          price = 6000;
          label = 'A å¼ + B2 å¼ + C å¼ å°ˆæ¡ˆåƒ¹';
          items = groupData.A.items.concat(groupData.B2.items, groupData.C.items);
        } else if (key === 'A+B2') {
          price = 6000;
          label = 'A å¼ + B2 å¼';
          items = groupData.A.items.concat(groupData.B2.items);
        } else if (key === 'A+B1') {
          price = 6000;
          label = 'A å¼ + B1 å¼';
          items = groupData.A.items.concat(groupData.B1.items);
        } else if (key === 'D') {
          price = groupData.D.price;
          label = 'D å¼ å°ˆæ¡ˆåƒ¹';
          items = groupData.D.items;
        } else {
          price = groupData[key].price;
          label = `${key} å¼ å°ˆæ¡ˆåƒ¹`;
          items = groupData[key].items;
        }

        const li = document.createElement('li');
        li.className = 'flex justify-between items-center gap-2 font-semibold text-green-700 text-lg';
        let removeKey = key;
        if (key === 'A+Bx+C') {
          removeKey = hasB1 ? 'A+B1+C' : 'A+B2+C';
        } else if (key === 'A+Bx+C+D') {
          removeKey = hasB1 ? 'A+B1+C+D' : 'A+B2+C+D';
        }
        li.innerHTML = `${label}ï¼ˆ${price} å…ƒï¼‰ <button onclick="removeGroupItems('${removeKey}')" class="text-red-500 text-sm">âŒ</button>`;
        selectedItems.appendChild(li);
        total += price;

        items.forEach(name => {
          const item = data.find(i => i.name === name);
          if (item) specimenMap[item.specimen] = (specimenMap[item.specimen] || 0) + 1;
        });
      });

      totalPrice.textContent = total;
      specimenSummary.textContent = Object.entries(specimenMap)
        .map(([key, value]) => `${key}é¡æª¢é«”ï¼š${value} é …`)
        .join('ï¼Œ');

      const imagingList = selected
        .filter(item => item.specimen === "å½±åƒ")
        .map(item => item.name)
        .filter(name => ["æ”è­·è…ºè¶…éŸ³æ³¢", "é ¸å‹•è„ˆè¶…éŸ³æ³¢", "éª¨ç›†è…”è¶…éŸ³æ³¢", "ç”²ç‹€è…ºè¶…éŸ³æ³¢", "ä¹³æˆ¿è¶…éŸ³æ³¢", "è…¹éƒ¨è¶…éŸ³æ³¢"].some(keyword => name.includes(keyword)));

      const tubeMap = {
        "åŒåŠèƒ±èƒºé…¸ Homocysteine": "ç´«é»ƒç®¡ ï¼‹1",
        "é…’ç²¾ä»£è¬åŸºå› æª¢æ¸¬": "å¤§ç´«ç®¡ ï¼‹1",
        "åœ°ä¸­æµ·å‹è²§è¡€(é›»æ³³)": "å°ç´«ç®¡ ï¼‹1",
        "è ¶è±†ç—‡G6PD": "å°ç´«ç®¡ ï¼‹1",
        "ApoEé˜¿èŒ²æµ·é»˜ç—‡é¢¨éšªåŸºå› æª¢æ¸¬": "å¤§ç´«ç®¡ ï¼‹1",
        "è†½ç´ è„‚é…¶(Cholinesterase)": "å°ç´…ç®¡ ï¼‹1",
        "çº–ç¶­è›‹ç™½åŸ": "æ·ºè—ç®¡ ï¼‹1",
        "è¡€æ “å› å­ D-Dimer": "æ·ºè—ç®¡ ï¼‹1",
        "é†£åŒ–è¡€è‰²ç´  (HbA1C)": "å°ç´«ç®¡ ï¼‹1",
        "Anti-ENAæŠ—é«”(CTD screen)": "å¤§ç´…ç®¡ ï¼‹1",
        "éæ•åŸæª¢æ¸¬-36é …": "å¤§ç´…ç®¡ ï¼‹1",
        "éæ•åŸæª¢æ¸¬-50é …": "å¤§ç´…ç®¡ ï¼‹2",
        "éæ•åŸæª¢æ¸¬-100é …": "å¤§ç´…ç®¡ ï¼‹3",
        "æ¢…æ¯’åæ‡‰(VDRL)": "å¤§ç´…ç®¡ ï¼‹1",
        "C13å°¿ç´ å‘¼æ°£æª¢æŸ¥å¹½é–€æ¡¿èŒ": "å¹æ°£è©¦é©— ï¼‹1",
        "ABOè¡€å‹": "å°ç´«ç®¡ ï¼‹1"
      };
      const tubeColorClass = {
        "ç´«é»ƒç®¡ ï¼‹1": "tube-purpleyellow",
        "å¤§ç´«ç®¡ ï¼‹1": "tube-purple",
        "å°ç´«ç®¡ ï¼‹1": "tube-purple",
        "å°ç´…ç®¡ ï¼‹1": "tube-red",
        "æ·ºè—ç®¡ ï¼‹1": "tube-lightblue",
        "å¤§ç´…ç®¡ ï¼‹1": "tube-red",
        "å¤§ç´…ç®¡ ï¼‹2": "tube-red",
        "å¤§ç´…ç®¡ ï¼‹3": "tube-red",
        "å¹æ°£è©¦é©— ï¼‹1": "tube-lightblue"
      };
      const tubes = [];
      selected.forEach(item => {
        for (const key in tubeMap) {
          if (item.name.includes(key)) {
            const tube = tubeMap[key];
            const colorClass = tubeColorClass[tube] || '';
            tubes.push(`ï¼ˆ${key}ï¼‰<span class="${colorClass}">${tube}</span>`);
          }
        }
      });

      const noteDiv = document.getElementById("package-note");
      let extraInfo = [];
      const imagingColorItems = imagingList.map(name => {
        if (["éª¨ç›†è…”è¶…éŸ³æ³¢", "ä¹³æˆ¿è¶…éŸ³æ³¢"].includes(name)) {
          return `<span class="imaging-b2">${name}</span>`;
        } else if (["æ”è­·è…ºè¶…éŸ³æ³¢"].includes(name)) {
          return `<span class="imaging-b1">${name}</span>`;
        }
        return name;
      });
      if (imagingColorItems.length > 0) {
        extraInfo.push(`<span class="imaging-label">å½±åƒé¡ï¼š</span>${imagingColorItems.join("ã€")}`);
      }
      if (tubes.length) {
        extraInfo.push(`<span class="tube-label">æ¡è¡€ç®¡ï¼š</span><span class="tube-content">${tubes.join("ï¼Œ")}</span>`);
      }
      noteDiv.innerHTML = extraInfo.join('<br>');
    }
    window.onload = () => {
      const gender = genderSelect.value;
      document.getElementById('marriage-male').classList.add('hidden');
      document.getElementById('marriage-female').classList.add('hidden');
      if (gender === 'male') document.getElementById('marriage-male').classList.remove('hidden');
      if (gender === 'female') document.getElementById('marriage-female').classList.remove('hidden');

      const marriageTip = document.getElementById('marriage-tip');
      if (gender === 'all') {
        marriageTip.classList.remove('hidden');
      } else {
        marriageTip.classList.add('hidden');
      }
      if (gender === 'male') {
        document.getElementById('box-b1').classList.remove('hidden');
        document.getElementById('box-b2').classList.add('hidden');
      } else if (gender === 'female') {
        document.getElementById('box-b2').classList.remove('hidden');
        document.getElementById('box-b1').classList.add('hidden');
      } else {
        document.getElementById('box-b1').classList.add('hidden');
        document.getElementById('box-b2').classList.add('hidden');
      }

      // æ§åˆ¶è¶…éŸ³æ³¢é …ç›®é¡¯ç¤º
      document.querySelector("li:has(button[onclick*=æ”è­·è…ºè¶…éŸ³æ³¢])").classList.add('hidden');
      document.querySelector("li:has(button[onclick*=éª¨ç›†è…”è¶…éŸ³æ³¢])").classList.add('hidden');
      document.querySelector("li:has(button[onclick*=ä¹³æˆ¿è¶…éŸ³æ³¢])").classList.add('hidden');
      if (gender === 'male') {
        document.querySelector("li:has(button[onclick*=æ”è­·è…ºè¶…éŸ³æ³¢])").classList.remove('hidden');
      } else if (gender === 'female') {
        document.querySelector("li:has(button[onclick*=éª¨ç›†è…”è¶…éŸ³æ³¢])").classList.remove('hidden');
        document.querySelector("li:has(button[onclick*=ä¹³æˆ¿è¶…éŸ³æ³¢])").classList.remove('hidden');
      }

      document.getElementById('box-b').classList.remove('hidden');
    };
  </script>
</body>

</html>